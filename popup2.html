<!doctype html>
<html>
  <head>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        width: 340px;
        padding: 16px;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-size: 13px;
        color: #333;
        background: #fafafa;
      }

      /* Status bar */
      #out {
        padding: 10px 12px;
        background: #fff;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        font-size: 12px;
        color: #555;
        min-height: 20px;
        margin-bottom: 12px;
      }

      /* Info panels */
      .info-panel {
        padding: 10px 12px;
        border-radius: 6px;
        font-size: 12px;
        margin-bottom: 10px;
        display: none;
      }

      .info-panel.visible {
        display: block;
      }

      .info-panel.span-info {
        background: #f0f7ff;
        border: 1px solid #cce0ff;
      }

      .info-panel.audio-info {
        background: #fff8f0;
        border: 1px solid #ffe0c0;
      }

      .info-panel.estimate-info {
        background: #f0fff4;
        border: 1px solid #c0f0d0;
      }

      .info-label {
        font-weight: 600;
        color: #666;
        font-size: 10px;
        text-transform: uppercase;
        letter-spacing: 0.3px;
        margin-bottom: 4px;
      }

      .info-value {
        color: #333;
        line-height: 1.4;
      }

      .info-value.preview {
        font-style: italic;
        color: #666;
        margin: 6px 0;
      }

      .info-row {
        display: flex;
        justify-content: space-between;
        margin-top: 6px;
        padding-top: 6px;
        border-top: 1px solid rgba(0,0,0,0.06);
      }

      .info-row span {
        color: #888;
        font-size: 11px;
      }

      .info-row strong {
        color: #333;
        font-weight: 600;
      }

      /* Buttons */
      .btn-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .btn-row {
        display: flex;
        gap: 8px;
      }

      button {
        flex: 1;
        padding: 10px 14px;
        font-family: inherit;
        font-size: 12px;
        font-weight: 500;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.15s ease;
      }

      button:active {
        transform: scale(0.98);
      }

      button.primary {
        background: #2563eb;
        color: white;
      }

      button.primary:hover {
        background: #1d4ed8;
      }

      button.secondary {
        background: #fff;
        color: #333;
        border: 1px solid #ddd;
      }

      button.secondary:hover {
        background: #f5f5f5;
        border-color: #ccc;
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      button.primary:disabled {
        background: #93c5fd;
      }

      button.secondary:disabled {
        background: #f5f5f5;
        color: #999;
      }

      /* Divider */
      .divider {
        height: 1px;
        background: #e5e5e5;
        margin: 12px 0;
      }

      /* Span input row */
      .input-row {
        display: flex;
        gap: 8px;
        align-items: center;
      }

      .input-row input {
        width: 70px;
        padding: 8px 10px;
        font-family: inherit;
        font-size: 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        text-align: center;
      }

      .input-row input:focus {
        outline: none;
        border-color: #2563eb;
      }
    </style>
  </head>
  <body>
    <div class="btn-group">
      <button id="run" class="primary">Extract Text</button>
    </div>

    <div class="divider"></div>

    <div id="out">Ready</div>

    <div id="spanInfo" class="info-panel span-info">
      <div class="info-label">Selected Span</div>
      <div class="info-value preview" id="spanText"></div>
      <div class="info-row">
        <span><strong id="spanLength">0</strong> characters</span>
        <span><strong id="spanWords">0</strong> words</span>
      </div>
    </div>

    <div id="audioInfo" class="info-panel audio-info">
      <div class="info-label">Generated Audio</div>
      <div class="info-row" style="margin-top: 0; padding-top: 0; border: none;">
        <span>WAV size</span>
        <span><strong id="wavSize">—</strong></span>
      </div>
    </div>

    <div id="estimateInfo" class="info-panel estimate-info">
      <div class="info-label">Full Document Estimate</div>
      <div class="info-row" style="margin-top: 0; padding-top: 0; border: none;">
        <span>Ratio</span>
        <span><strong id="ratioDisplay">—</strong> bytes/char</span>
      </div>
      <div class="info-row">
        <span>Total text</span>
        <span><strong id="totalChars">—</strong> chars</span>
      </div>
      <div class="info-row">
        <span>Est. audio size</span>
        <span><strong id="estimatedSize">—</strong></span>
      </div>
    </div>

    <div class="divider"></div>

    <div class="btn-group">
      <div class="btn-row">
        <button id="copy" class="secondary" disabled>Copy Text</button>
        <button id="openTab" class="secondary" disabled>Open in Tab</button>
      </div>
      <div class="btn-row">
        <button id="playFirst" class="primary" disabled>Play First Span</button>
      </div>
      <div class="input-row">
        <input type="number" id="spanIndex" min="0" value="0" disabled>
        <button id="playSpanN" class="primary" disabled>Play Span N</button>
      </div>
      <div class="btn-row">
        <button id="estimate" class="secondary" disabled>Estimate Full Audio</button>
      </div>
    </div>

    <script src="popup.js"></script>
  </body>
</html>
